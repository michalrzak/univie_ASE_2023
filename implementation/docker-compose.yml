x-common-variables: &common-variables
  DEBUG: "false"
  RABBITMQ-HOST: "rabbitmq"


services:
  analyticReport:
    image: analyticreport
    build: analyticReport
    networks:
      analyticReport-rabbit:

  attendance:
    image: attendance
    build: attendance
    networks:
      attendance-rabbit:

  event:
    image: event
    build: event
    networks:
      event-rabbit:

  feedback:
    image: feedback
    build: feedback
    networks:
      feedback-rabbit:

  login:
    image: login
    build: login
    networks:
      login-rabbit:
    environment:
      <<: *common-variables
      JWT-SECRET: "top-secret"
      JWT-EXPIRATION-TIME: "900000"
    volumes:
      - ./.persistence/login:/persistence

  maintenance:
    image: maintenance
    build: maintenance
    networks:
      maintenance-rabbit:

  notification:
    image: notification
    build: notification
    networks:
      notification-rabbit:

  recommender:
    image: recommender
    build: recommender
    networks:
      recommender-rabbit:

  searchServiceEvents:
    image: searchserviceevents
    build: searchServiceEvents
    networks:
      searchServiceEvent-rabbit:

  sendNotification:
    image: sendnotification
    build: sendNotification
    networks:
      sendNotification-rabbit:
    environment:
      <<: *common-variables
      NOTIFICATION_SENDER_EMAIL: <email>
      NOTIFICATION_SENDER_PASSWORD: <password>
    volumes:
      - ./.persistence/sendNotification:/persistence

  rabbitmq:
    image: rabbitmq
    networks:
      analyticReport-rabbit:
      attendance-rabbit:
      event-rabbit:
      feedback-rabbit:
      login-rabbit:
      maintenance-rabbit:
      notification-rabbit:
      recommender-rabbit:
      searchServiceEvent-rabbit:
      sendNotification-rabbit:

networks:
  analyticReport-rabbit:
    name: analyticReport-rabbit
  attendance-rabbit:
    name: attendance-rabbit
  event-rabbit:
    name: event-rabbit
  feedback-rabbit:
    name: feedback-rabbit
  login-rabbit:
    name: login-rabbit
  maintenance-rabbit:
    name: maintenance-rabbit
  notification-rabbit:
    name: notification-rabbit
  recommender-rabbit:
    name: recommender-rabbit
  searchServiceEvent-rabbit:
    name: searchServiceEvent-rabbit
  sendNotification-rabbit:
    name: sendNotification-rabbit
